import{d as I,i as x,l as Y,m as R,n as U,q as V}from"./chunk-XMS53VVL.js";import{Z as P,a as N}from"./chunk-H2UEIIB4.js";import{$ as _,Bb as y,Cb as p,Gb as O,Ib as E,Kb as b,Lb as L,Mb as u,Nb as r,Xb as f,cb as o,d as S,ea as C,hb as A,hc as d,ic as h,jc as T,k as l,ma as g,pb as M,qc as D,t as v,vb as m}from"./chunk-OF6GQXFW.js";var i={TRX_TYPE:"transactionType",ASSET_TYPE:"assetType",ASSET_STATE:"assetState",PRICING_MODEL:"pricingModel",SUPPLY_TYPES:"supplyTypes",ACCOUNT_LEVEL:"level",TRADING_MODEL:"tradingModel",MARKET:"market",EXECUTION_MODEL:"executionModel"},w={[i.TRX_TYPE]:"/general/sysvars/Transaction%20Type",[i.ASSET_TYPE]:"/general/sysvars/Asset%20Type",[i.ASSET_STATE]:"/general/sysvars/Asset%20State",[i.PRICING_MODEL]:"/general/sysvars/Asset%20Pricing%20Model",[i.SUPPLY_TYPES]:"/general/sysvars/Asset%20Supply%20Type",[i.ACCOUNT_LEVEL]:"/general/sysvars/Account%20Level",[i.TRADING_MODEL]:"/general/sysvars/Asset%20Trading%20Model",[i.EXECUTION_MODEL]:"/general/sysvars/Asset%20Execution%20Model",[i.MARKET]:"/general/countries/list"};var j=(()=>{class a{constructor(e){this.http=e,this.enumSubjects={[i.TRX_TYPE]:new l({}),[i.ASSET_TYPE]:new l({}),[i.ASSET_STATE]:new l({}),[i.PRICING_MODEL]:new l({}),[i.SUPPLY_TYPES]:new l({}),[i.ACCOUNT_LEVEL]:new l({}),[i.TRADING_MODEL]:new l({}),[i.EXECUTION_MODEL]:new l({}),[i.MARKET]:new l({})},this.cache={},this.enumUrlMapping=w}getEnumData(e,t){let n=this.enumSubjects[e]?.value||{};return t?Object.entries(n).map(([c,F])=>({value:c,label:F})):n}fetchEnumData(e){return S(this,null,function*(){if(this.cache[e])return Object.entries(this.cache[e]).map(([t,n])=>({id:Number(t),name:n}));try{let t=yield v(this.http.get(this.enumUrlMapping[e])),n=[];return"countries"in t?n=t.countries?.map(c=>({id:c.countryId,name:c.fullName}))||[]:n=t.sysvars||[],this.cache[e]=this.formatEnumData(n),n}catch(t){return console.error(`Failed to fetch enum data for ${e}:`,t),this.loadFallbackEnums(e),[]}})}formatEnumData(e){return e.reduce((t,{id:n,name:c})=>(t[n]=c,t),{})}loadEnums(e){return S(this,null,function*(){try{for(let t of Object.keys(this.enumSubjects))if(!e||e.includes(t)){let n=yield this.fetchEnumData(t);this.enumSubjects[t].next(this.formatEnumData(n))}}catch(t){console.error("Error loading enums:",t)}})}loadFallbackEnums(e){let t={[i.TRX_TYPE]:{1:"Sell",2:"Buy",3:"P2P"},[i.ASSET_TYPE]:{1:"Precious Metals",2:"Real Estate",3:"Media & Artworks",4:"Carbon Credits"},[i.ASSET_STATE]:{1:"Initialized",2:"Active",3:"Suspended",4:"Deactivated"},[i.PRICING_MODEL]:{1:"Fixed Source",2:"Open Market"},[i.SUPPLY_TYPES]:{1:"Fixed",2:"Dynamic"},[i.ACCOUNT_LEVEL]:{1:"Level 0",2:"Level 1",3:"Level 2",4:"Level 3"},[i.TRADING_MODEL]:{1:"Locked",2:"Open"},[i.EXECUTION_MODEL]:{1:"OnChain",2:"On/Off",3:"Off/On"},[i.MARKET]:{818:"Egypt",682:"Saudi Arabia"}};t[e]?this.enumSubjects[e].next(t[e]):console.warn(`No fallback data available for ${e}`)}static{this.\u0275fac=function(t){return new(t||a)(C(N))}}static{this.\u0275prov=_({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var X=a=>({"is-invalid":a}),K=(a,s)=>s.value;function $(a,s){if(a&1&&(u(0,"option",5),d(1),r()),a&2){let e=s.$implicit;p("value",e.value),o(),h(e.label)}}function q(a,s){if(a&1&&b(0,$,2,2,"option",5,K),a&2){let e=f();L(e.options)}}function B(a,s){if(a&1&&(u(0,"small"),d(1),r()),a&2){let e=f(2);o(),T("",e.label," is required")}}function z(a,s){if(a&1&&(u(0,"div",4),m(1,B,2,1,"small"),r()),a&2){let e=f();o(),E(e.control.errors!=null&&e.control.errors.required?1:-1)}}var ie=(()=>{class a{constructor(e){this.enumService=e,this.excludeValues=[],this.enabled=!0,this.isLoading=!0,this.options=[]}ngOnInit(){this.enabled&&this.enumService.loadEnums([this.key]).then(()=>this.getOptions())}ngOnChanges(e){e.enabled&&!e.enabled.firstChange&&this.enabled&&this.enumService.loadEnums([this.key]).then(()=>this.getOptions())}getOptions(){if(this.excludeValues?this.options=this.enumService.getEnumData(this.key,!0).filter(t=>!this.excludeValues.includes(t.value)):this.options=this.enumService.getEnumData(this.key,!0),this.isLoading=!1,this.defaultValue===void 0)return;let e=this.options.find(t=>t.value==this.defaultValue);e&&(this.control.setValue(e.value),this.control.markAsDirty(),this.control.markAsTouched())}static{this.\u0275fac=function(t){return new(t||a)(A(j))}}static{this.\u0275cmp=M({type:a,selectors:[["app-async-select"]],inputs:{key:"key",control:"control",controlName:"controlName",label:"label",placeholder:"placeholder",defaultValue:"defaultValue",excludeValues:"excludeValues",enabled:"enabled"},features:[g],decls:8,vars:12,consts:[[1,"mb-3"],["cLabel",""],["cSelect","",3,"id","formControl"],["value","","disabled","",3,"selected"],[1,"text-danger","mb-2","d-flex","align-items-center","justify-content-end"],[3,"value"]],template:function(t,n){t&1&&(u(0,"div",0)(1,"label",1),d(2),r(),u(3,"select",2)(4,"option",3),d(5),r(),m(6,q,2,0),r(),m(7,z,2,1,"div",4),r()),t&2&&(o(),y("for",n.controlName),o(),h(n.label),o(),O(D(10,X,n.control.invalid&&n.control.touched)),p("id",n.controlName)("formControl",n.control),o(),p("selected",!n.control.value),o(),T(" ",n.isLoading?"Loading...":!n.isLoading&&n.options.length===0?"No options available":n.placeholder," "),o(),E(n.options.length>0?6:-1),o(),E(n.control.invalid&&(n.control.dirty||n.control.touched)?7:-1))},dependencies:[V,R,U,Y,I,x,P],styles:["select.ng-pristine[_ngcontent-%COMP%]{color:#a7a8ac}"]})}}return a})();export{i as a,ie as b};
