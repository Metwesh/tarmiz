import{a as ie,b as oe,c as C,d as A,e as le,f as ae,g as re,h as se,i as ce,j as me,k as pe,l as de,m as ue,n as Ce,o as x}from"./chunk-RWLWIXKE.js";import{$ as Z,A as B,H as z,I as H,K,W as $,Y as J,Z as Q,_ as W,a as M,ca as ee,da as te,x as G,y as X,ya as ne}from"./chunk-DLRE2GSZ.js";import{$ as P,Eb as U,Fb as d,Hb as b,Jb as R,Lb as u,Nb as Y,Ob as w,Pb as r,Qb as o,Rb as m,Yb as q,_b as y,cb as a,d as F,ea as k,hb as h,k as E,kc as s,lc as S,mc as D,pa as L,pb as T,qa as N,qc as V,t as O,vb as p,zc as j}from"./chunk-SNB637Z6.js";var l={TRX_TYPE:"transactionType",ASSET_TYPE:"assetType",ASSET_STATE:"assetState",PRICING_MODEL:"pricingModel",SUPPLY_TYPES:"supplyTypes",ACCOUNT_LEVEL:"level",TRADING_MODEL:"tradingModel",MARKET:"market",EXECUTION_MODEL:"executionModel"},_e={[l.TRX_TYPE]:"/general/sysvars/Transaction%20Type",[l.ASSET_TYPE]:"/general/sysvars/Asset%20Type",[l.ASSET_STATE]:"/general/sysvars/Asset%20State",[l.PRICING_MODEL]:"/general/sysvars/Pricing%20Model",[l.SUPPLY_TYPES]:"/general/sysvars/Supply%20Type",[l.ACCOUNT_LEVEL]:"/general/sysvars/Account%20Level",[l.TRADING_MODEL]:"/general/sysvars/Trading%20Model",[l.MARKET]:"/general/countries/list",[l.EXECUTION_MODEL]:"/general/sysvars/Execution%20Model"};var Ee=(()=>{class n{constructor(e){this.http=e,this.enumSubjects={[l.TRX_TYPE]:new E({}),[l.ASSET_TYPE]:new E({}),[l.ASSET_STATE]:new E({}),[l.PRICING_MODEL]:new E({}),[l.SUPPLY_TYPES]:new E({}),[l.ACCOUNT_LEVEL]:new E({}),[l.TRADING_MODEL]:new E({}),[l.EXECUTION_MODEL]:new E({}),[l.MARKET]:new E({})},this.cache={},this.enumUrlMapping=_e}getEnumData(e,i){let t=this.enumSubjects[e]?.value||{};return i?Object.entries(t).map(([_,f])=>({value:_,label:f})):t}fetchEnumData(e){return F(this,null,function*(){if(this.cache[e])return Object.entries(this.cache[e]).map(([i,t])=>({id:Number(i),name:t}));try{let i=yield O(this.http.get(this.enumUrlMapping[e])),t=[];return"countries"in i?t=i.countries?.map(_=>({id:_.code,name:_.nameShort}))||[]:t=i.sysvars||[],this.cache[e]=this.formatEnumData(t),t}catch(i){return console.error(`Failed to fetch enum data for ${e}:`,i),this.loadFallbackEnums(e),[]}})}formatEnumData(e){return e.reduce((i,{id:t,name:_})=>(i[t]=_,i),{})}loadEnums(e){return F(this,null,function*(){try{for(let i of Object.keys(this.enumSubjects))if(!e||e.includes(i)){let t=yield this.fetchEnumData(i);this.enumSubjects[i].next(this.formatEnumData(t))}}catch(i){console.error("Error loading enums:",i)}})}loadFallbackEnums(e){let i={[l.TRX_TYPE]:{1:"Sell",2:"Buy",3:"P2P"},[l.ASSET_TYPE]:{1:"Precious Metals",2:"Real Estate",3:"Media & Artworks",4:"Carbon Credits"},[l.ASSET_STATE]:{1:"Initialized",2:"Active",3:"Suspended",4:"Deactivated"},[l.PRICING_MODEL]:{1:"Fixed Source",2:"Open Market"},[l.SUPPLY_TYPES]:{1:"Fixed",2:"Dynamic"},[l.ACCOUNT_LEVEL]:{1:"Level 0",2:"Level 1",3:"Level 2",4:"Level 3"},[l.TRADING_MODEL]:{1:"Locked",2:"Open"},[l.EXECUTION_MODEL]:{1:"OnChain",2:"On/Off",3:"Off/On"},[l.MARKET]:{818:"Egypt",682:"Saudi Arabia"}};i[e]?this.enumSubjects[e].next(i[e]):console.warn(`No fallback data available for ${e}`)}static{this.\u0275fac=function(i){return new(i||n)(k(M))}}static{this.\u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ge=n=>({"is-invalid":n}),Te=(n,c)=>c.value;function be(n,c){if(n&1&&(r(0,"option",5),s(1),o()),n&2){let e=c.$implicit;d("value",e.value),a(),S(e.label)}}function Me(n,c){if(n&1&&Y(0,be,2,2,"option",5,Te),n&2){let e=y();w(e.options)}}function Ae(n,c){if(n&1&&(r(0,"small"),s(1),o()),n&2){let e=y(2);a(),D("",e.label," is required")}}function xe(n,c){if(n&1&&(r(0,"div",4),p(1,Ae,2,1,"small"),o()),n&2){let e=y();a(),u(e.control.errors!=null&&e.control.errors.required?1:-1)}}var fe=(()=>{class n{constructor(e,i){this.enumService=e,this.cdr=i,this.isLoading=!0,this.options=[]}ngOnInit(){this.enumService.loadEnums([this.key]).then(()=>this.getOptions())}getOptions(){this.options=this.enumService.getEnumData(this.key,!0),this.isLoading=!1}static{this.\u0275fac=function(i){return new(i||n)(h(Ee),h(j))}}static{this.\u0275cmp=T({type:n,selectors:[["app-async-select"]],inputs:{key:"key",control:"control",controlName:"controlName",label:"label",placeholder:"placeholder"},decls:8,vars:12,consts:[[1,"mb-3"],["cLabel",""],["cSelect","",3,"id","formControl"],["value","","disabled","",3,"selected"],[1,"text-danger","mb-2","d-flex","align-items-center","justify-content-end"],[3,"value"]],template:function(i,t){i&1&&(r(0,"div",0)(1,"label",1),s(2),o(),r(3,"select",2)(4,"option",3),s(5),o(),p(6,Me,2,0),o(),p(7,xe,2,1,"div",4),o()),i&2&&(a(),U("for",t.controlName),a(),S(t.label),a(),R(V(10,ge,t.control.invalid&&t.control.touched)),d("id",t.controlName)("formControl",t.control),a(),d("selected",!t.control.value),a(),D(" ",t.isLoading?"Loading...":!t.isLoading&&t.options.length===0?"No options available":t.placeholder," "),a(),u(t.options.length>0?6:-1),a(),u(t.control.invalid&&(t.control.dirty||t.control.touched)?7:-1))},dependencies:[x,de,ue,pe,A,se,$],styles:["select.ng-pristine[_ngcontent-%COMP%]{color:#a7a8ac}"]})}}return n})();function Fe(n,c){n&1&&(r(0,"small"),s(1,"Name is required"),o())}function Le(n,c){if(n&1&&(r(0,"div",5),p(1,Fe,2,0,"small"),o()),n&2){let e,i=y();a(),u(!((e=i.assetForm.get("name"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Ne(n,c){n&1&&(r(0,"small"),s(1,"Symbol is required"),o())}function De(n,c){if(n&1&&(r(0,"div",5),p(1,Ne,2,0,"small"),o()),n&2){let e,i=y();a(),u(!((e=i.assetForm.get("symbol"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Ie(n,c){n&1&&(r(0,"small"),s(1,"Supply is required"),o())}function Oe(n,c){if(n&1&&(r(0,"div",5),p(1,Ie,2,0,"small"),o()),n&2){let e,i=y(2);a(),u(!((e=i.assetForm.get("supply"))==null||e.errors==null)&&e.errors.required?1:-1)}}function Pe(n,c){if(n&1&&(r(0,"c-col")(1,"div",2)(2,"label",25),s(3,"Supply"),o(),m(4,"input",26),p(5,Oe,2,1,"div",5),o()()),n&2){let e,i,t=y();a(4),b("is-invalid",((e=t.assetForm.get("supply"))==null?null:e.invalid)&&((e=t.assetForm.get("supply"))==null?null:e.touched)),a(),u((i=t.assetForm.get("supply"))!=null&&i.invalid&&((i=t.assetForm.get("supply"))!=null&&i.dirty||(i=t.assetForm.get("supply"))!=null&&i.touched)?5:-1)}}function ke(n,c){if(n&1&&(L(),m(0,"svg",28),N(),r(1,"span"),s(2),o()),n&2){let e=y(2);a(2),S(e.successMessage)}}function Ue(n,c){if(n&1&&(L(),m(0,"svg",29),N(),r(1,"span"),s(2),o()),n&2){let e=y(2);a(2),S(e.errorMessage)}}function Re(n,c){if(n&1&&(r(0,"c-alert",18)(1,"div",27),p(2,ke,3,1)(3,Ue,3,1),o()()),n&2){let e=y();d("color",e.successMessage?"success":"danger"),a(2),u(e.successMessage?2:3)}}function Ye(n,c){n&1&&(m(0,"c-spinner",30),s(1," Loading... "))}function we(n,c){n&1&&s(0," Submit ")}var We=(()=>{class n{constructor(e,i){this.fb=e,this.http=i,this.submitting=!1,this.successMessage="",this.errorMessage="",this.assetTypeUrl=l.ASSET_TYPE,this.pricingModelUrl=l.PRICING_MODEL,this.supplyTypesUrl=l.SUPPLY_TYPES,this.accountLevelUrl=l.ACCOUNT_LEVEL,this.tradingModelUrl=l.TRADING_MODEL,this.executionModelUrl=l.EXECUTION_MODEL,this.marketUrl=l.MARKET,this.assetForm=this.fb.group({name:["",[C.required,C.minLength(3)]],symbol:["",[C.required,C.minLength(3)]],assetType:["",[C.required]],exclusive:[!1,[C.required]],supplyType:["",[C.required]],supply:[""],pricingModel:["",[C.required]],tradingModel:["",[C.required]],executionModel:["",[C.required]],cid:[""],marketId:["",[C.required]],level:["",[C.required]],extra:[""]})}ngOnInit(){this.assetForm.get("supplyType")?.valueChanges.subscribe(e=>{let i=this.assetForm.get("supply");e==="1"?i?.setValidators([C.required]):i?.clearValidators(),i?.updateValueAndValidity()})}isInvalid(e){let i=this.assetForm.get(e);return i?i.invalid&&(i.dirty||i.touched):!1}onSubmit(){if(this.submitting=!0,this.assetForm.invalid){this.errorMessage="Please fill all required fields correctly.",this.submitting=!1;return}this.successMessage="",this.errorMessage="",this.http.post("/account/create/asset",this.assetForm.value).subscribe({next:()=>{this.successMessage="Asset created successfully!",this.assetForm.reset(),this.submitting=!1},error:e=>{this.errorMessage=e.error,this.submitting=!1}})}static{this.\u0275fac=function(i){return new(i||n)(h(Ce),h(M))}}static{this.\u0275cmp=T({type:n,selectors:[["app-asset-create"]],decls:51,vars:25,consts:[["cForm","","autocomplete","off",1,"mb-4",3,"ngSubmit","formGroup"],[1,"row-cols-2"],[1,"mb-3"],["cLabel","","for","name"],["cFormControl","","id","name","type","text","placeholder","Enter asset name","formControlName","name"],[1,"text-danger","small","text-end"],["cLabel","","for","symbol"],["cFormControl","","id","symbol","type","text","placeholder","Enter symbol","formControlName","symbol"],["controlName","assetType","label","Asset Type","placeholder","Choose asset type",3,"key","control"],["controlName","supplyType","label","Supply Type","placeholder","Choose supply type",3,"key","control"],["controlName","pricingModel","label","Pricing Model","placeholder","Choose pricing model",3,"key","control"],["controlName","tradingModel","label","Trading Model","placeholder","Choose trading model",3,"key","control"],["controlName","executionModel","label","Execution Model","placeholder","Choose execution model",3,"key","control"],["controlName","marketId","label","Market","placeholder","Choose market",3,"key","control"],["controlName","level","label","Account Level","placeholder","Choose level",3,"key","control"],["xs","12"],["cLabel","","for","extra"],["cFormControl","","id","extra","formControlName","extra","placeholder","Enter extra info","rows","3"],[3,"color"],[1,"align-items-center"],["sizing","lg","switch",""],["cFormCheckInput","","type","checkbox","formControlName","exclusive"],["cFormCheckLabel",""],[1,"text-end"],["cButton","","color","primary","type","submit",3,"disabled"],["cLabel","","for","supply"],["cFormControl","","id","supply","type","number","placeholder","Enter supply","formControlName","supply"],[1,"d-flex","align-items-center","gap-2"],["cIcon","","name","cilCheckCircle","size","sm"],["cIcon","","name","cilBellExclamation","size","sm"],["size","sm"]],template:function(i,t){if(i&1&&(r(0,"form",0),q("ngSubmit",function(){return t.onSubmit()}),r(1,"c-card")(2,"c-card-header")(3,"strong"),s(4,"Create Asset"),o()(),r(5,"c-card-body")(6,"c-row",1)(7,"c-col")(8,"div",2)(9,"label",3),s(10,"Name"),o(),m(11,"input",4),p(12,Le,2,1,"div",5),o()(),r(13,"c-col")(14,"div",2)(15,"label",6),s(16,"Symbol"),o(),m(17,"input",7),p(18,De,2,1,"div",5),o()(),r(19,"c-col"),m(20,"app-async-select",8),o(),r(21,"c-col"),m(22,"app-async-select",9),o(),p(23,Pe,6,3,"c-col"),r(24,"c-col"),m(25,"app-async-select",10),o(),r(26,"c-col"),m(27,"app-async-select",11),o(),r(28,"c-col"),m(29,"app-async-select",12),o(),r(30,"c-col"),m(31,"app-async-select",13),o(),r(32,"c-col"),m(33,"app-async-select",14),o()(),r(34,"c-row")(35,"c-col",15)(36,"div",2)(37,"label",16),s(38,"Extra"),o(),m(39,"textarea",17),o()()(),p(40,Re,4,2,"c-alert",18),r(41,"c-row",19)(42,"c-col")(43,"c-form-check",20),m(44,"input",21),r(45,"label",22),s(46,"Exclusive"),o()()(),r(47,"c-col",23)(48,"button",24),p(49,Ye,2,0)(50,we,1,0),o()()()()()()),i&2){let _,f,g,v,I;d("formGroup",t.assetForm),a(11),b("is-invalid",((_=t.assetForm.get("name"))==null?null:_.invalid)&&((_=t.assetForm.get("name"))==null?null:_.touched)),a(),u((f=t.assetForm.get("name"))!=null&&f.invalid&&((f=t.assetForm.get("name"))!=null&&f.dirty||(f=t.assetForm.get("name"))!=null&&f.touched)?12:-1),a(5),b("is-invalid",((g=t.assetForm.get("symbol"))==null?null:g.invalid)&&((g=t.assetForm.get("symbol"))==null?null:g.touched)),a(),u((v=t.assetForm.get("symbol"))!=null&&v.invalid&&((v=t.assetForm.get("symbol"))!=null&&v.dirty||(v=t.assetForm.get("symbol"))!=null&&v.touched)?18:-1),a(2),d("key",t.assetTypeUrl)("control",t.assetForm.controls.assetType),a(2),d("key",t.supplyTypesUrl)("control",t.assetForm.controls.supplyType),a(),u(((I=t.assetForm.get("supplyType"))==null?null:I.value)!=="2"?23:-1),a(2),d("key",t.pricingModelUrl)("control",t.assetForm.controls.pricingModel),a(2),d("key",t.tradingModelUrl)("control",t.assetForm.controls.tradingModel),a(2),d("key",t.executionModelUrl)("control",t.assetForm.controls.executionModel),a(2),d("key",t.marketUrl)("control",t.assetForm.controls.marketId),a(2),d("key",t.accountLevelUrl)("control",t.assetForm.controls.level),a(7),u(t.successMessage||t.errorMessage?40:-1),a(8),d("disabled",t.submitting||t.assetForm.invalid),a(),u(t.submitting?49:50)}},dependencies:[x,ae,oe,re,ie,A,le,ce,me,ee,te,H,z,K,X,Q,Z,W,J,fe,ne,B,G],encapsulation:2})}}return n})();export{We as AssetCreateComponent};
