import{d as x,i as Y,l as R,m as U,n as V,q as j}from"./chunk-XMS53VVL.js";import{Z as I,a as P}from"./chunk-H2UEIIB4.js";import{$ as C,Bb as O,Cb as p,Gb as b,Ib as E,Kb as L,Lb as D,Mb as u,Nb as l,Xb as f,cb as o,d as h,ea as g,hb as y,hc as d,ic as T,jc as v,k as r,ma as A,pb as M,qc as N,t as _,vb as m}from"./chunk-OF6GQXFW.js";var i={TRX_TYPE:"transactionType",ASSET_TYPE:"assetType",ASSET_STATE:"assetState",PRICING_MODEL:"pricingModel",SUPPLY_TYPES:"supplyTypes",ACCOUNT_LEVEL:"level",TRADING_MODEL:"tradingModel",MARKET:"market",EXECUTION_MODEL:"executionModel"},w={[i.TRX_TYPE]:"/general/sysvars/Transaction%20Type",[i.ASSET_TYPE]:"/general/sysvars/Asset%20Type",[i.ASSET_STATE]:"/general/sysvars/Asset%20State",[i.PRICING_MODEL]:"/general/sysvars/Asset%20Pricing%20Model",[i.SUPPLY_TYPES]:"/general/sysvars/Asset%20Supply%20Type",[i.ACCOUNT_LEVEL]:"/general/sysvars/Account%20Level",[i.TRADING_MODEL]:"/general/sysvars/Asset%20Trading%20Model",[i.EXECUTION_MODEL]:"/general/sysvars/Asset%20Execution%20Model",[i.MARKET]:"/general/countries/list"};var F=(()=>{class a{constructor(e){this.http=e,this.enumSubjects={[i.TRX_TYPE]:new r({}),[i.ASSET_TYPE]:new r({}),[i.ASSET_STATE]:new r({}),[i.PRICING_MODEL]:new r({}),[i.SUPPLY_TYPES]:new r({}),[i.ACCOUNT_LEVEL]:new r({}),[i.TRADING_MODEL]:new r({}),[i.EXECUTION_MODEL]:new r({}),[i.MARKET]:new r({})},this.cache={},this.enumUrlMapping=w}getEnumData(e,t){let n=this.enumSubjects[e]?.value||{};return t?(Object.entries(n),Object.entries(n).map(([s,S])=>({value:s,label:S}))):n}fetchEnumData(e){return h(this,null,function*(){if(this.cache[e])return Object.entries(this.cache[e]).map(([t,n])=>({id:Number(t),name:n}));try{let t=yield _(this.http.get(this.enumUrlMapping[e])),n=[];return"countries"in t?n=t.countries?.map(s=>({id:s.countryId,name:s.fullName}))||[]:n=t.sysvars?t.sysvars.map(({sysvarId:s,name:S})=>({id:s,name:S})):[],this.cache[e]=this.formatEnumData(n),n}catch(t){return console.error(`Failed to fetch enum data for ${e}:`,t),this.loadFallbackEnums(e),[]}})}formatEnumData(e){return e.reduce((t,{id:n,name:s})=>(t[n]=s,t),{})}loadEnums(e){return h(this,null,function*(){try{for(let t of Object.keys(this.enumSubjects))if(!e||e.includes(t)){let n=yield this.fetchEnumData(t);this.enumSubjects[t].next(this.formatEnumData(n))}}catch(t){console.error("Error loading enums:",t)}})}loadFallbackEnums(e){let t={[i.TRX_TYPE]:{1:"Sell",2:"Buy",3:"P2P"},[i.ASSET_TYPE]:{1:"Precious Metals",2:"Real Estate",3:"Media & Artworks",4:"Carbon Credits"},[i.ASSET_STATE]:{1:"Initialized",2:"Active",3:"Suspended",4:"Deactivated"},[i.PRICING_MODEL]:{1:"Fixed Source",2:"Open Market"},[i.SUPPLY_TYPES]:{1:"Fixed",2:"Dynamic"},[i.ACCOUNT_LEVEL]:{1:"Level 0",2:"Level 1",3:"Level 2",4:"Level 3"},[i.TRADING_MODEL]:{1:"Locked",2:"Open"},[i.EXECUTION_MODEL]:{1:"OnChain",2:"On/Off",3:"Off/On"},[i.MARKET]:{818:"Egypt",682:"Saudi Arabia"}};t[e]?this.enumSubjects[e].next(t[e]):console.warn(`No fallback data available for ${e}`)}static{this.\u0275fac=function(t){return new(t||a)(g(P))}}static{this.\u0275prov=C({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var X=a=>({"is-invalid":a}),K=(a,c)=>c.value;function $(a,c){if(a&1&&(u(0,"option",5),d(1),l()),a&2){let e=c.$implicit;p("value",e.value),o(),T(e.label)}}function q(a,c){if(a&1&&L(0,$,2,2,"option",5,K),a&2){let e=f();D(e.options)}}function B(a,c){if(a&1&&(u(0,"small"),d(1),l()),a&2){let e=f(2);o(),v("",e.label," is required")}}function z(a,c){if(a&1&&(u(0,"div",4),m(1,B,2,1,"small"),l()),a&2){let e=f();o(),E(e.control.errors!=null&&e.control.errors.required?1:-1)}}var ie=(()=>{class a{constructor(e){this.enumService=e,this.excludeValues=[],this.enabled=!0,this.isLoading=!0,this.options=[]}ngOnInit(){this.enabled&&this.enumService.loadEnums([this.key]).then(()=>this.getOptions())}ngOnChanges(e){e.enabled&&!e.enabled.firstChange&&this.enabled&&this.enumService.loadEnums([this.key]).then(()=>this.getOptions())}getOptions(){if(this.excludeValues?this.options=this.enumService.getEnumData(this.key,!0).filter(t=>!this.excludeValues.includes(t.value)):this.options=this.enumService.getEnumData(this.key,!0),this.isLoading=!1,this.defaultValue===void 0)return;let e=this.options.find(t=>t.value==this.defaultValue);e&&(this.control.setValue(e.value),this.control.markAsDirty(),this.control.markAsTouched())}static{this.\u0275fac=function(t){return new(t||a)(y(F))}}static{this.\u0275cmp=M({type:a,selectors:[["app-async-select"]],inputs:{key:"key",control:"control",controlName:"controlName",label:"label",placeholder:"placeholder",defaultValue:"defaultValue",excludeValues:"excludeValues",enabled:"enabled"},features:[A],decls:8,vars:12,consts:[[1,"mb-3"],["cLabel",""],["cSelect","",3,"id","formControl"],["value","","disabled","",3,"selected"],[1,"text-danger","mb-2","d-flex","align-items-center","justify-content-end"],[3,"value"]],template:function(t,n){t&1&&(u(0,"div",0)(1,"label",1),d(2),l(),u(3,"select",2)(4,"option",3),d(5),l(),m(6,q,2,0),l(),m(7,z,2,1,"div",4),l()),t&2&&(o(),O("for",n.controlName),o(),T(n.label),o(),b(N(10,X,n.control.invalid&&n.control.touched)),p("id",n.controlName)("formControl",n.control),o(),p("selected",!n.control.value),o(),v(" ",n.isLoading?"Loading...":!n.isLoading&&n.options.length===0?"No options available":n.placeholder," "),o(),E(n.options.length>0?6:-1),o(),E(n.control.invalid&&(n.control.dirty||n.control.touched)?7:-1))},dependencies:[j,U,V,R,x,Y,I],styles:["select.ng-pristine[_ngcontent-%COMP%]{color:#a7a8ac}"]})}}return a})();export{i as a,ie as b};
